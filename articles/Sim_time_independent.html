<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation of Time-independent Effects • Survinng</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of Time-independent Effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Survinng</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Sim_time_dependent.html">Simulation of Time-dependent Effects</a></li>
    <li><a class="dropdown-item" href="../articles/Sim_time_independent.html">Simulation of Time-independent Effects</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation of Time-independent Effects</h1>
            
      

      <div class="d-none name"><code>Sim_time_independent.Rmd</code></div>
    </div>

    
    
<p>In this vignette we simulate survival data to detect time-independent
feature effects using gradient-based explanation techniques for survival
neural network models.</p>
<p>Load the necessary libraries and source the utility functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nkoenen.github.io/Survinng/">Survinng</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html" class="external-link">survminer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://torch.mlverse.org/docs" class="external-link">torch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="time-independent-effects">Time-independent effects<a class="anchor" aria-label="anchor" href="#time-independent-effects"></a>
</h3>
</div>
<div class="section level2">
<h2 id="generate-the-data">Generate the data<a class="anchor" aria-label="anchor" href="#generate-the-data"></a>
</h2>
<p>We consider a simulated dataset with the following
characteristics:</p>
<ul>
<li>
<strong>Sample size:</strong> 10,000 individuals
<ul>
<li>9,500 samples used for training<br>
</li>
<li>500 samples used for testing</li>
</ul>
</li>
<li>
<strong>Covariates:</strong>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_1 \sim N(0, 1)</annotation></semantics></math>:
has a <strong>positive effect</strong> on the hazard<br>
→ <strong>Negative effect</strong> on survival</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub><mo>∼</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_2 \sim U(0, 1)</annotation></semantics></math>:
has a <strong>strong negative effect</strong> on the hazard<br>
→ <strong>Positive effect</strong> on survival</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>3</mn></msub><mo>∼</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_3 \sim U(-1, 1)</annotation></semantics></math>:
has <strong>no effect</strong> on the hazard or survival</p></li>
</ul>
</li>
<li>
<strong>Time-dependency:</strong> None of the covariates have
time-varying effects</li>
</ul>
</div>
<div class="section level2">
<h2 id="load-models-and-data">Load Models and Data<a class="anchor" aria-label="anchor" href="#load-models-and-data"></a>
</h2>
<p>The models used in this vignette are the same as those used in the
main paper. The models were trained using the
<code>survivalmodels</code> package, and the training process is not
shown here, but can be found in the
<code>vignettes/articles/Sim_time_independent</code> directory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/articles/Sim_time_independent/train.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/articles/Sim_time_independent/test.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load extracted models</span></span>
<span><span class="va">ext_coxtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/articles/Sim_time_independent/ext_coxtime.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ext_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/articles/Sim_time_independent/ext_deepsurv.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ext_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/articles/Sim_time_independent/ext_deephit.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-explainer">Create Explainer<a class="anchor" aria-label="anchor" href="#create-explainer"></a>
</h2>
<p>The <code><a href="../reference/explain.html">explain()</a></code> function creates an explainer object for
the survival models. The <code>data</code> argument specifies the
dataset used for explanation, and the <code>model</code> argument
specifies the model to be explained. The <code>target</code> argument
indicates the type of prediction to be explained (e.g., “survival”,
“risk”, “cumulative hazard”).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_deephit</span> <span class="op">&lt;-</span> <span class="fu">Survinng</span><span class="fu">::</span><span class="fu"><a href="../reference/explain.html">explain</a></span><span class="op">(</span><span class="va">ext_deephit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, data <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="va">exp_coxtime</span> <span class="op">&lt;-</span> <span class="fu">Survinng</span><span class="fu">::</span><span class="fu"><a href="../reference/explain.html">explain</a></span><span class="op">(</span><span class="va">ext_coxtime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, data <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="va">exp_deepsurv</span> <span class="op">&lt;-</span> <span class="fu">Survinng</span><span class="fu">::</span><span class="fu"><a href="../reference/explain.html">explain</a></span><span class="op">(</span><span class="va">ext_deepsurv</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, data <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>The performance of the models is evaluated using the C-Index and
Integrated Brier Score (IBS). The C-Index measures the concordance
between predicted and observed survival times, while the IBS quantifies
the accuracy of survival predictions.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Model</th>
<th align="center">C-Index</th>
<th align="center">IBS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">CoxTime</td>
<td align="center">0.809372</td>
<td align="center">0.099053</td>
</tr>
<tr class="even">
<td align="center">DeepSurv</td>
<td align="center">0.809121</td>
<td align="center">0.099031</td>
</tr>
<tr class="odd">
<td align="center">DeepHit</td>
<td align="center">0.808829</td>
<td align="center">0.141614</td>
</tr>
</tbody>
</table>
<p><img src="Sim_time_independent/sim_tid_brier_plot.png" width="80%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="survival-prediction">Survival Prediction<a class="anchor" aria-label="anchor" href="#survival-prediction"></a>
</h3>
<p>The survival predictions for the test dataset are computed using the
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function. The <code>type</code> argument
specifies the type of prediction to be made (e.g., “survival”, “risk”,
“cumulative hazard”). The survival predictions are then plotted for a
set of instances of interest.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print instances of interest</span></span>
<span><span class="va">tid_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">387</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span><span class="va">tid_ids</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;           time status        x1        x2          x3</span></span>
<span><span class="co">#&gt; 343  2.6653596      1 -0.434617 0.1162303 -0.08053765</span></span>
<span><span class="co">#&gt; 7906 0.9577924      1  2.454611 0.2462072 -0.04249294</span></span>
<span></span>
<span><span class="co"># Compute Vanilla Gradient</span></span>
<span><span class="va">grad_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span><span class="op">)</span></span>
<span><span class="va">grad_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_deephit</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span><span class="op">)</span></span>
<span><span class="va">grad_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot survival predictions</span></span>
<span><span class="va">surv_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_surv_pred</span><span class="op">(</span><span class="va">grad_cox</span><span class="op">)</span> ,</span>
<span>  <span class="fu">plot_surv_pred</span><span class="op">(</span><span class="va">grad_deephit</span><span class="op">)</span>,</span>
<span>  <span class="fu">plot_surv_pred</span><span class="op">(</span><span class="va">grad_deepsurv</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span>,</span>
<span>  label_x <span class="op">=</span> <span class="fl">0.03</span>,      </span>
<span>  label_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> </span>
<span><span class="va">surv_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/survival%20pred-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="explainable-ai">Explainable AI<a class="anchor" aria-label="anchor" href="#explainable-ai"></a>
</h2>
<p>The following sections demonstrate the application of various
gradient-based explanation methods to the survival models. The methods
include Grad(t), SmoothGrad(t), G x I(t), SmoothGrad x I(t), IntGrad(t),
and GradSHAP(t). Each method provides insights into the contributions of
the covariates to the survival predictions.</p>
<div class="section level3">
<h3 id="gradt-sensitivity">Grad(t) (Sensitivity)<a class="anchor" aria-label="anchor" href="#gradt-sensitivity"></a>
</h3>
<p>Here we compute the gradient of the survival predictions with respect
to the input features. The <code><a href="../reference/surv_grad.html">surv_grad()</a></code> function computes
the gradients for the specified instances.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot attributions</span></span>
<span><span class="va">grad_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">grad_cox</span>, label <span class="op">=</span> <span class="st">"Grad(t)"</span><span class="op">)</span> ,</span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">grad_deephit</span>, label <span class="op">=</span> <span class="st">"Grad(t)"</span><span class="op">)</span>,</span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">grad_deepsurv</span>, label <span class="op">=</span> <span class="st">"Grad(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grad_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradient-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="smoothgradt-sensitivity">SmoothGrad(t) (Sensitivity)<a class="anchor" aria-label="anchor" href="#smoothgradt-sensitivity"></a>
</h3>
<p>SmoothGrad(t) is a method that adds noise to the input features and
computes the average gradient over multiple noisy samples. This approach
helps to reduce the noise in the gradient estimates and provides a
clearer picture of the feature importance.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute SmoothGrad</span></span>
<span><span class="va">sg_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">sg_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_deephit</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">sg_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, target <span class="op">=</span> <span class="st">"survival"</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot attributions</span></span>
<span><span class="va">smoothgrad_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sg_cox</span>, label <span class="op">=</span> <span class="st">"SG(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sg_deephit</span>, label <span class="op">=</span> <span class="st">"SG(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sg_deepsurv</span>, label <span class="op">=</span> <span class="st">"SG(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">smoothgrad_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20smoothgrad-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="grad-x-it">Grad x I(t)<a class="anchor" aria-label="anchor" href="#grad-x-it"></a>
</h3>
<p>Grad x I(t) is a method that computes the gradient of the survival
predictions with respect to the input features and multiplies it by the
survival predictions themselves. This approach provides insights into
the true local effects of the covariates on the survival prediction.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute GradientxInput</span></span>
<span><span class="va">gradin_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gradin_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_deephit</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gradin_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_grad.html">surv_grad</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot attributions</span></span>
<span><span class="va">gradin_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gradin_cox</span>, label <span class="op">=</span> <span class="st">"GxI(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gradin_deephit</span>, label <span class="op">=</span> <span class="st">"GxI(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gradin_deepsurv</span>, label <span class="op">=</span> <span class="st">"GxI(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gradin_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradientxinput-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot attributions</span></span>
<span><span class="va">grad_gradin_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">grad_deepsurv</span>, label <span class="op">=</span> <span class="st">"Grad(t)"</span><span class="op">)</span> ,</span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gradin_deepsurv</span>, label <span class="op">=</span> <span class="st">"GxI(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DeepSurv"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grad_gradin_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradient%20and%20gradientin-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="smoothgrad-x-it">SmoothGrad x I(t)<a class="anchor" aria-label="anchor" href="#smoothgrad-x-it"></a>
</h3>
<p>SmoothGrad x I(t) is a method that adds noise to the input features
and computes the average gradient over multiple noisy samples,
multiplied by the survival predictions. This approach helps to reduce
the noise in the gradient estimates and provides a clearer picture of
the feature importance.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute SmoothGradxInput</span></span>
<span><span class="va">sgin_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                          times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sgin_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_deephit</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                              times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sgin_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_smoothgrad.html">surv_smoothgrad</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, noise_level <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                               times_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot attributions</span></span>
<span><span class="va">smoothgradin_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sgin_cox</span>, label <span class="op">=</span> <span class="st">"SGxI(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sgin_deephit</span>, label <span class="op">=</span> <span class="st">"SGxI(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">sgin_deepsurv</span>, label <span class="op">=</span> <span class="st">"SGxI(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">smoothgradin_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20smoothgradxinput-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="intgradt">IntGrad(t)<a class="anchor" aria-label="anchor" href="#intgradt"></a>
</h3>
<p>IntGrad(t) is a method that computes the integral of the gradients
along a straight line path from a reference point to the input instance.
This method provides a more comprehensive view of the feature importance
by considering the cumulative effect of the features over time.</p>
</div>
</div>
<div class="section level2">
<h2 id="zero-baseline-should-be-proportional-to-gradient-x-it">Zero baseline (should be proportional to Gradient x I(t))<a class="anchor" aria-label="anchor" href="#zero-baseline-should-be-proportional-to-gradient-x-it"></a>
</h2>
<p>The zero baseline is a reference point where all features are set to
zero.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute IntegratedGradient with 0 baseline</span></span>
<span><span class="va">x_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ig0_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_intgrad.html">surv_intgrad</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, x_ref <span class="op">=</span> <span class="va">x_ref</span><span class="op">)</span></span>
<span><span class="va">ig0_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_intgrad.html">surv_intgrad</a></span><span class="op">(</span><span class="va">exp_deephit</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, x_ref <span class="op">=</span> <span class="va">x_ref</span><span class="op">)</span></span>
<span><span class="va">ig0_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_intgrad.html">surv_intgrad</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, x_ref <span class="op">=</span> <span class="va">x_ref</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot attributions</span></span>
<span><span class="va">intgrad0_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_cox</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_deephit</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_deepsurv</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intgrad0_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20intgrad0-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot attributions</span></span>
<span><span class="va">intgrad0_plot_comp</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_cox</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_deephit</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">ig0_deepsurv</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intgrad0_plot_comp</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20intgrad0%20comp-1.png" width="100%" style="display: block; margin: auto;"></p>
<p> effectively visualize the normalized absolute contribution of each
feature to the difference between reference and (survival) prediction
over time.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot contributions</span></span>
<span><span class="va">intgrad0_plot_contr</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">ig0_cox</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">ig0_deephit</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">ig0_deepsurv</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intgrad0_plot_contr</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20intgrad0%20contr-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Complementarily, emphasize the relative contribution and direction of
each feature at a set of representative survival times.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot force</span></span>
<span><span class="va">intgrad0_plot_force</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">ig0_cox</span>, upper_distance <span class="op">=</span> <span class="fl">0.04</span>, lower_distance <span class="op">=</span> <span class="fl">0.04</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">ig0_deephit</span>, upper_distance <span class="op">=</span> <span class="fl">0.02</span>, lower_distance <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">ig0_deepsurv</span>, upper_distance <span class="op">=</span> <span class="fl">0.04</span>, lower_distance <span class="op">=</span> <span class="fl">0.04</span>, label <span class="op">=</span> <span class="st">"IntGrad(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">intgrad0_plot_force</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20intgrad0%20force-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="gradshap">GradShap<a class="anchor" aria-label="anchor" href="#gradshap"></a>
</h3>
<p>GradSHAP(t) is a method that computes the SHAP values for survival
predictions. It provides a measure of the contribution of each feature
to the survival predictions, taking into account the time-dependent
effects.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute GradShap</span></span>
<span><span class="va">gshap_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_gradSHAP.html">surv_gradSHAP</a></span><span class="op">(</span><span class="va">exp_coxtime</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, num_samples <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">gshap_deephit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_gradSHAP.html">surv_gradSHAP</a></span><span class="op">(</span><span class="va">exp_deephit</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, num_samples <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">gshap_deepsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surv_gradSHAP.html">surv_gradSHAP</a></span><span class="op">(</span><span class="va">exp_deepsurv</span>, instance <span class="op">=</span> <span class="va">tid_ids</span>, n <span class="op">=</span> <span class="fl">50</span>, num_samples <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot attributions</span></span>
<span><span class="va">gshap_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_cox</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_deephit</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_deepsurv</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gshap_plot</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradshap-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot attributions</span></span>
<span><span class="va">gshap_plot_comp</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_cox</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_deephit</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_attribution</span><span class="op">(</span><span class="va">gshap_deepsurv</span>, add_comp <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gshap_plot_comp</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradshap%20comp-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot contributions %</span></span>
<span><span class="va">gshap_plot_contr</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">gshap_cox</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">gshap_deephit</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_contribution</span><span class="op">(</span><span class="va">gshap_deepsurv</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gshap_plot_contr</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradshap%20contr-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot force</span></span>
<span><span class="va">gshap_plot_force</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">gshap_cox</span>, upper_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance_x1 <span class="op">=</span> <span class="fl">0.05</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">gshap_deephit</span>, upper_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance_x1 <span class="op">=</span> <span class="fl">0.02</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>, </span>
<span>  <span class="fu">plot_force</span><span class="op">(</span><span class="va">gshap_deepsurv</span>, upper_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance <span class="op">=</span> <span class="fl">0</span>, lower_distance_x1 <span class="op">=</span> <span class="fl">0.04</span>, label <span class="op">=</span> <span class="st">"GradSHAP(t)"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CoxTime"</span>, <span class="st">"DeepHit"</span>, <span class="st">"DeepSurv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gshap_plot_force</span></span></code></pre></div>
<p><img src="Sim_time_independent_files/figure-html/tid%20gradshap%20force-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Koenen, Sophie Hanna Langbein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
